var C=Object.defineProperty,R=Object.defineProperties;var A=Object.getOwnPropertyDescriptors;var f=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var y=(a,e,o)=>e in a?C(a,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[e]=o,V=(a,e)=>{for(var o in e||(e={}))E.call(e,o)&&y(a,o,e[o]);if(f)for(var o of f(e))F.call(e,o)&&y(a,o,e[o]);return a},v=(a,e)=>R(a,A(e));import{j as i,s as d,y as s,z as u,L as T,F as x,B as I,K as B,A as z,p as r,u as n,M as _,N as $,O as p}from"./vue.594b3409.js";import{s as D,d as m,N as L}from"./index.2908eb61.js";import{d as j,b as q,_ as k,y as M,e as h,f as G,r as U,u as w,h as g,p as K,j as O}from"./vendor.f983317d.js";const P={class:"container"},H={class:"mb-3"},J={class:"form-label"},Q=["placeholder","value"],c={__name:"BaseInput",props:{label:{type:String,default:""},modelValue:{type:[String,Number],default:""}},setup(a){return(e,o)=>(i(),d("div",P,[s("div",H,[s("label",J,u(a.label),1),s("input",{type:"text",class:"form-control",placeholder:a.label,value:a.modelValue,onInput:o[0]||(o[0]=t=>e.$emit("update:modelValue",t.target.value))},null,40,Q)])]))}},W={class:"container"},X={class:"mb-3"},Y={class:"form-label"},Z=["placeholder","value"],ee={__name:"BaseInputDate",props:{label:{type:String,default:""},modelValue:{type:[Date,String,Number],default:""}},setup(a){return(e,o)=>(i(),d("div",W,[s("div",X,[s("label",Y,u(a.label),1),s("input",{type:"date",class:"form-control",placeholder:a.label,value:a.modelValue,onInput:o[0]||(o[0]=t=>e.$emit("update:modelValue",t.target.value))},null,40,Z)])]))}},te={class:"container"},ae={class:"mb-3"},oe={class:"form-label"},le=["placeholder","value"],se={__name:"BaseTextArea",props:{label:{type:String,default:""},modelValue:{type:[String,Number],default:""}},setup(a){return(e,o)=>(i(),d("div",te,[s("div",ae,[s("label",oe,u(a.label),1),s("textarea",{type:"text",class:"form-control",placeholder:a.label,value:a.modelValue,onInput:o[0]||(o[0]=t=>e.$emit("update:modelValue",t.target.value)),rows:"3"},null,40,le)])]))}},ne={class:"container"},re={class:"mb-3"},ie={class:"form-label"},de=["value"],ue=["value","selected"],ce={__name:"BaseSeleccion",props:{opciones:{type:Array,required:!0},label:{type:String,default:""},modelValue:{type:[String,Number],default:""}},setup(a){return(e,o)=>(i(),d("div",ne,[s("div",re,[s("label",ie,u(a.label),1),s("select",T({class:"form-select",value:a.modelValue},v(V({},e.$attrs),{onChange:t=>{e.$emit("update:modelValue",t.target.value)}})),[(i(!0),d(x,null,I(a.opciones,t=>(i(),d("option",{value:t,key:t,selected:t===a.modelValue},u(t),9,ue))),128))],16,de)])]))}},S=B(),me=j({id:"principal",state:()=>({file:null,datoImagen:null,error:null,editar:!1,loading:!1,urlDescarga:"",ages:["2 anos","3 anos","4 anos","Todas as idades","Recomendado para adultos"],obras:[],obra:{id:"",title:"",company:"",director:"",cast:"",synopsis:"",date:"",link:"",age:"",time:"",photo:""}}),actions:{async obtenerDatos(){this.obras=[],(await q(k(m,"obras"))).forEach(e=>{let o=e.data();o.id=e.id,this.obras.push(o),console.log(o)})},async eliminarDato(a){await M(h(m,"obras",a)),S.go("/")},async obtenerDatoID(a){const e=h(m,"obras",a),o=await G(e);o.exists()?(this.obra=o.data(),this.obra.id=o.id):console.log("\xA1No existe el documento!")},buscarImagen(a){const e=a.target.files[0].type;if(e==="image/jpeg"||e==="image/png")this.file=a.target.files[0],this.error=null;else{this.error="Archivo no v\xE1lido",this.file=null;return}const o=new FileReader;o.readAsDataURL(this.file),o.onload=t=>{this.datoImagen=t.target.result}},async agregarDato(){try{this.loading=!0;const a=U(D,"imagenes/"+this.file.name),e=w(a,this.file);e.on("state_changed",t=>{const l=t.bytesTransferred/t.totalBytes*100;switch(console.log("Upload is "+l+"% done"),t.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running");break}},t=>{},()=>{g(e.snapshot.ref).then(t=>{console.log("File available at",t)})});const o=await g(a);await K(k(m,"obras"),{title:this.obra.title,company:this.obra.company,director:this.obra.director,cast:this.obra.cast,synopsis:this.obra.synopsis,age:this.obra.age,link:this.obra.link,time:this.obra.time,date:this.obra.date,photo:o}),this.error="Imagen subida con \xE9xito",this.file=null}catch(a){console.log(a)}finally{B().push("/"),this.loading=!1}},async actualizarDato(){try{this.loading=!0;const a=U(D,"imagenes/"+this.file.name),e=w(a,this.file);e.on("state_changed",l=>{const b=l.bytesTransferred/l.totalBytes*100;switch(console.log("Upload is "+b+"% done"),l.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running");break}},l=>{},()=>{g(e.snapshot.ref).then(l=>{console.log("File available at",l)})});const o=await g(a),t=h(m,"obras",this.obra.id);await O(t,{title:this.obra.title,company:this.obra.company,director:this.obra.director,cast:this.obra.cast,synopsis:this.obra.synopsis,age:this.obra.age,link:this.obra.link,time:this.obra.time,date:this.obra.date,photo:o}),this.error="Imagen subida con \xE9xito",this.file=null}catch(a){console.log(a)}finally{S.push("/"),this.loading=!1}}}}),be={class:"container my-4"},pe={class:"input-group my-3"},ge={class:"mt-3"},he={class:"mt-4"},fe=["src"],ye={class:"table"},Ve={scope:"row"},ve=["onClick"],_e=["onClick"],we={__name:"Formulario",setup(a){const e=me();return z(()=>{e.obtenerDatos()}),(o,t)=>(i(),d("div",null,[r(L),s("div",be,[s("form",null,[r(c,{modelValue:n(e).obra.company,"onUpdate:modelValue":t[0]||(t[0]=l=>n(e).obra.company=l),type:"text",label:"Compa\xF1ia"},null,8,["modelValue"]),r(c,{modelValue:n(e).obra.title,"onUpdate:modelValue":t[1]||(t[1]=l=>n(e).obra.title=l),type:"text",label:"T\xEDtulo"},null,8,["modelValue"]),r(c,{modelValue:n(e).obra.director,"onUpdate:modelValue":t[2]||(t[2]=l=>n(e).obra.director=l),type:"text",label:"Director"},null,8,["modelValue"]),r(c,{modelValue:n(e).obra.cast,"onUpdate:modelValue":t[3]||(t[3]=l=>n(e).obra.cast=l),type:"text",label:"Elenco"},null,8,["modelValue"]),r(se,{modelValue:n(e).obra.synopsis,"onUpdate:modelValue":t[4]||(t[4]=l=>n(e).obra.synopsis=l),type:"text",label:"Descripci\xF3n"},null,8,["modelValue"]),r(c,{modelValue:n(e).obra.link,"onUpdate:modelValue":t[5]||(t[5]=l=>n(e).obra.link=l),type:"text",label:"Enlace"},null,8,["modelValue"]),r(ce,{modelValue:n(e).obra.age,"onUpdate:modelValue":t[6]||(t[6]=l=>n(e).obra.age=l),opciones:n(e).ages,label:"Selecciona una categor\xEDa"},null,8,["modelValue","opciones"]),r(c,{modelValue:n(e).obra.time,"onUpdate:modelValue":t[7]||(t[7]=l=>n(e).obra.time=l),type:"text",default:"60 minutos",label:"Duraci\xF3n"},null,8,["modelValue"]),r(ee,{modelValue:n(e).obra.date,"onUpdate:modelValue":t[8]||(t[8]=l=>n(e).obra.date=l),type:"date",label:"Fecha"},null,8,["modelValue"]),r(c,{modelValue:n(e).obra.photo,"onUpdate:modelValue":t[9]||(t[9]=l=>n(e).obra.photo=l),type:"text",label:"Imagen"},null,8,["modelValue"]),s("div",pe,[s("input",{type:"file",onChange:t[10]||(t[10]=l=>n(e).buscarImagen(l))},null,32)]),s("div",ge,[_(s("button",{onClick:t[11]||(t[11]=p(l=>n(e).actualizarDato(o.id),["prevent"])),class:"btn btn-primary"}," Actualizar ",512),[[$,n(e).editar===!0]]),_(s("button",{onClick:t[12]||(t[12]=p(l=>n(e).agregarDato(),["prevent"])),class:"btn btn-primary"}," Guardar ",512),[[$,n(e).editar===!1]]),s("div",he,[s("img",{src:n(e).datoImagen},null,8,fe)])])])]),s("table",ye,[t[13]||(t[13]=s("thead",null,[s("tr",null,[s("th",{scope:"col"},"id"),s("th",{scope:"col"},"Author"),s("th",{scope:"col"},"Fecha"),s("th",{scope:"col"},"Editar"),s("th",{scope:"col"},"Eliminar")])],-1)),s("tbody",null,[(i(!0),d(x,null,I(n(e).obras,(l,b)=>(i(),d("tr",{key:b},[s("th",Ve,u(b),1),s("td",null,u(l.company),1),s("td",null,u(l.date),1),s("td",null,[s("button",{onClick:p(N=>{n(e).obtenerDatoID(l.id),this.datos.editar=!this.datos.editar},["prevent"]),class:"btn btn-primary"},"Editar ",8,ve)]),s("td",null,[s("button",{onClick:p(N=>n(e).eliminarDato(l.id),["prevent"]),class:"btn btn-danger"},"Eliminar ",8,_e)])]))),128))])])]))}};export{we as default};
