var E=Object.defineProperty,A=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var $=(a,e,o)=>e in a?E(a,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[e]=o,h=(a,e)=>{for(var o in e||(e={}))B.call(e,o)&&$(a,o,e[o]);if(V)for(var o of V(e))C.call(e,o)&&$(a,o,e[o]);return a},_=(a,e)=>A(a,N(e));import{j as d,s as u,x as t,y as c,L as R,F as S,A as x,J as F,r as D,z,p as i,u as r,M as w,N as I,O as y}from"./vue.14856ed3.js";import{d as L,b as T,_ as k,y as j,e as f,f as M,r as q,u as H,h as P,p as G,j as J}from"./vendor.e7d07fff.js";import{d as b,s as O}from"./index.13a6e9e3.js";const K={class:"container"},Q={class:"mb-3"},W={class:"form-label"},X=["placeholder","value"],m={__name:"BaseInput",props:{label:{type:String,default:""},modelValue:{type:[String,Number],default:""}},setup(a){return(e,o)=>(d(),u("div",K,[t("div",Q,[t("label",W,c(a.label),1),t("input",{type:"text",class:"form-control",placeholder:a.label,value:a.modelValue,onInput:o[0]||(o[0]=n=>e.$emit("update:modelValue",n.target.value))},null,40,X)])]))}},Y={class:"container"},Z={class:"mb-3"},ee={class:"form-label"},ae=["placeholder","value"],te={__name:"BaseInputDate",props:{label:{type:String,default:""},modelValue:{type:[Date,String,Number],default:""}},setup(a){return(e,o)=>(d(),u("div",Y,[t("div",Z,[t("label",ee,c(a.label),1),t("input",{type:"date",class:"form-control",placeholder:a.label,value:a.modelValue,onInput:o[0]||(o[0]=n=>e.$emit("update:modelValue",n.target.value))},null,40,ae)])]))}},oe={class:"container"},le={class:"mb-3"},se={class:"form-label"},re=["placeholder","value"],ne={__name:"BaseTextArea",props:{label:{type:String,default:""},modelValue:{type:[String,Number],default:""}},setup(a){return(e,o)=>(d(),u("div",oe,[t("div",le,[t("label",se,c(a.label),1),t("textarea",{type:"text",class:"form-control",placeholder:a.label,value:a.modelValue,onInput:o[0]||(o[0]=n=>e.$emit("update:modelValue",n.target.value)),rows:"3"},null,40,re)])]))}},ie={class:"container"},de={class:"mb-3"},ue={class:"form-label"},ce=["value"],me=["value","selected"],pe={__name:"BaseSeleccion",props:{opciones:{type:Array,required:!0},label:{type:String,default:""},modelValue:{type:[String,Number],default:""}},setup(a){return(e,o)=>(d(),u("div",ie,[t("div",de,[t("label",ue,c(a.label),1),t("select",R({class:"form-select",value:a.modelValue},_(h({},e.$attrs),{onChange:n=>{e.$emit("update:modelValue",n.target.value)}})),[(d(!0),u(S,null,x(a.opciones,n=>(d(),u("option",{value:n,key:n,selected:n===a.modelValue},c(n),9,me))),128))],16,ce)])]))}};F();const be=L({id:"principal",state:()=>({file:null,datoImagen:null,error:null,editar:!1,loading:!1,urlDescarga:"",ages:["A partir de 2 anos","A partir de 3 anos","A partir de 4 anos","A partir de 13 anos","A partir de 18 anos"],obras:[],obra:{id:"",title:"",company:"",director:"",cast:"",synopsis:"",date:"",link:"",age:"",price:"",photo:""}}),actions:{async obtenerDatos(){try{const a=await T(k(b,"obras"));this.obras=a.docs.map(e=>h({id:e.id},e.data()))}catch(a){console.error("Error al obtener datos:",a)}},async eliminarDato(a){try{await j(f(b,"obras",a)),this.obtenerDatos()}catch(e){console.error("Error al eliminar dato:",e)}},async obtenerDatoID(a){try{const e=await M(f(b,"obras",a));e.exists()?this.obra=h({id:e.id},e.data()):console.warn("\xA1No existe el documento!")}catch(e){console.error("Error al obtener dato por ID:",e)}},buscarImagen(a){const e=a.target.files[0];if(e&&["image/jpeg","image/png"].includes(e.type)){this.file=e,this.error=null;const o=new FileReader;o.readAsDataURL(e),o.onload=n=>{this.datoImagen=n.target.result}}else this.error="Archivo no v\xE1lido",this.file=null},async subirImagen(){if(!this.file)throw new Error("No hay archivo para subir");const a=q(O,`imagenes/${this.file.name}`),e=H(a,this.file);return new Promise((o,n)=>{e.on("state_changed",null,p=>n(p),async()=>{const p=await P(e.snapshot.ref);o(p)})})},async agregarDato(){try{this.loading=!0;const a=await this.subirImagen();await G(k(b,"obras"),{title:this.obra.title,company:this.obra.company,director:this.obra.director,cast:this.obra.cast,synopsis:this.obra.synopsis,age:this.obra.age,link:this.obra.link,price:this.obra.price,date:this.obra.date,photo:a}),this.error="Datos guardados con \xE9xito",this.file=null,this.obtenerDatos()}catch(a){console.error("Error al agregar datos:",a)}finally{this.loading=!1}},async actualizarDato(){try{this.loading=!0;const a=this.file?await this.subirImagen():this.obra.photo,e=f(b,"obras",this.obra.id);await J(e,{title:this.obra.title,company:this.obra.company,director:this.obra.director,cast:this.obra.cast,synopsis:this.obra.synopsis,age:this.obra.age,link:this.obra.link,price:this.obra.price,date:this.obra.date,photo:a}),this.error="Datos actualizados con \xE9xito",this.file=null,this.obtenerDatos()}catch(a){console.error("Error al actualizar datos:",a)}finally{this.loading=!1}}}}),he={class:"container"},ye={class:"mb-3"},ge={class:"form-label"},fe=["placeholder","value"],ve={__name:"BaseInputTime",props:{label:{type:String,default:""},modelValue:{type:[Date,String,Number],default:""}},setup(a){return(e,o)=>(d(),u("div",he,[t("div",ye,[t("label",ge,c(a.label),1),t("input",{type:"time",class:"form-control",placeholder:a.label,value:a.modelValue,onInput:o[0]||(o[0]=n=>e.$emit("update:modelValue",n.target.value))},null,40,fe)])]))}},Ve={class:"container my-4"},$e={class:"input-group my-3"},_e={class:"mt-3"},De={class:"mt-4"},we=["src"],Ie={class:"table"},ke={scope:"row"},Se=["onClick"],xe=["onClick"],Be={__name:"Formulario",setup(a){const e=be(),o=D(""),n=D("");z(()=>{e.obtenerDatos()});const p=()=>{if(o.value&&n.value){const g=new Date(`${o.value}T${n.value}:00`);e.obra.date=g}};return(g,l)=>(d(),u("div",null,[t("div",Ve,[t("form",null,[i(m,{modelValue:r(e).obra.company,"onUpdate:modelValue":l[0]||(l[0]=s=>r(e).obra.company=s),type:"text",label:"Compa\xF1ia"},null,8,["modelValue"]),i(m,{modelValue:r(e).obra.title,"onUpdate:modelValue":l[1]||(l[1]=s=>r(e).obra.title=s),type:"text",label:"T\xEDtulo"},null,8,["modelValue"]),i(m,{modelValue:r(e).obra.director,"onUpdate:modelValue":l[2]||(l[2]=s=>r(e).obra.director=s),type:"text",label:"Director"},null,8,["modelValue"]),i(m,{modelValue:r(e).obra.cast,"onUpdate:modelValue":l[3]||(l[3]=s=>r(e).obra.cast=s),type:"text",label:"Elenco"},null,8,["modelValue"]),i(ne,{modelValue:r(e).obra.synopsis,"onUpdate:modelValue":l[4]||(l[4]=s=>r(e).obra.synopsis=s),type:"text",label:"Descripci\xF3n"},null,8,["modelValue"]),i(m,{modelValue:r(e).obra.link,"onUpdate:modelValue":l[5]||(l[5]=s=>r(e).obra.link=s),type:"text",label:"Enlace"},null,8,["modelValue"]),i(pe,{modelValue:r(e).obra.age,"onUpdate:modelValue":l[6]||(l[6]=s=>r(e).obra.age=s),opciones:r(e).ages,label:"Selecciona una categor\xEDa"},null,8,["modelValue","opciones"]),i(m,{modelValue:r(e).obra.time,"onUpdate:modelValue":l[7]||(l[7]=s=>r(e).obra.time=s),type:"text",default:"60 minutos",label:"Duraci\xF3n"},null,8,["modelValue"]),i(te,{modelValue:o.value,"onUpdate:modelValue":l[8]||(l[8]=s=>o.value=s),type:"date",label:"Fecha"},null,8,["modelValue"]),i(ve,{modelValue:n.value,"onUpdate:modelValue":l[9]||(l[9]=s=>n.value=s),type:"time",label:"Hora"},null,8,["modelValue"]),i(m,{modelValue:r(e).obra.photo,"onUpdate:modelValue":l[10]||(l[10]=s=>r(e).obra.photo=s),type:"text",label:"Imagen"},null,8,["modelValue"]),t("div",$e,[t("input",{type:"file",onChange:l[11]||(l[11]=s=>r(e).buscarImagen(s))},null,32)]),t("div",_e,[w(t("button",{onClick:l[12]||(l[12]=y(s=>{p(),r(e).actualizarDato(g.id)},["prevent"])),class:"btn btn-primary"}," Actualizar ",512),[[I,r(e).editar===!0]]),w(t("button",{onClick:l[13]||(l[13]=y(s=>{p(),r(e).agregarDato()},["prevent"])),class:"btn btn-primary"}," Guardar ",512),[[I,r(e).editar===!1]]),t("div",De,[t("img",{src:r(e).datoImagen},null,8,we)])])])]),t("table",Ie,[l[14]||(l[14]=t("thead",null,[t("tr",null,[t("th",{scope:"col"},"id"),t("th",{scope:"col"},"Author"),t("th",{scope:"col"},"Fecha"),t("th",{scope:"col"},"Editar"),t("th",{scope:"col"},"Eliminar")])],-1)),t("tbody",null,[(d(!0),u(S,null,x(r(e).obras,(s,v)=>(d(),u("tr",{key:v},[t("th",ke,c(v),1),t("td",null,c(s.company),1),t("td",null,c(s.date),1),t("td",null,[t("button",{onClick:y(U=>{r(e).obtenerDatoID(s.id),r(e).editar=!r(e).editar},["prevent"]),class:"btn btn-primary"},"Editar ",8,Se)]),t("td",null,[t("button",{onClick:y(U=>r(e).eliminarDato(s.id),["prevent"]),class:"btn btn-danger"},"Eliminar ",8,xe)])]))),128))])])]))}};export{Be as default};
